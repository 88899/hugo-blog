{{/* 分类数据处理逻辑（保持不变） */}}
{{ $allCategories := site.Taxonomies.categories.ByCount | default slice }}
{{ $englishCats := slice }}
{{ $chineseCats := slice }}

{{ range where $allCategories "Page" "!=" nil }}
  {{ $name := .Name | default "" }}
  {{ if and $name (findRE "^[A-Za-z]+$" $name) }}
    {{ $englishCats = $englishCats | append . }}
  {{ else if $name }}
    {{ $chineseCats = $chineseCats | append . }}
  {{ end }}
{{ end }}

{{ $sortedEnglish := sort $englishCats "Name" "asc" | default slice }}
{{ $sortedChinese := sort $chineseCats "Name" "asc" | default slice }}
{{ $categories := $sortedEnglish | append $sortedChinese | first 6 }}

{{ if $categories }}
<style>
/* 全局清零：移除所有可能触发GPU的属性 */
.category-container {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6px 0;
  width: 100%;
  overflow: hidden;
}

/* 导航条：零阴影、零过渡、零复杂样式 */
.category-bg-bar {
  /* 亮色模式：纯白实色，无阴影，仅1px细边框 */
  background: #ffffff;
  border: 1px solid #e0e0e0;
  border-radius: 50px;
  padding: 10px 36px;
  display: inline-flex;
  align-items: center;
  max-width: 95vw;
}

/* 彻底移除hover动画：仅文字反馈，无任何布局/样式变动 */
.category-bg-bar:hover {
  border-color: #e0e0e0; /* 边框不变，避免重绘 */
}

/* 暗黑模式：纯黑实色，零阴影，仅1px细边框 */
html.dark .category-bg-bar {
  background: #1e1e1e;
  border: 1px solid #333;
}

html.dark .category-bg-bar:hover {
  border-color: #333; /* 边框不变 */
}

/* 标签样式：仅文字颜色变化，无其他过渡 */
.category-tag {
  color: #666; /* 亮色默认文字 */
  font-size: 1.0rem;
  font-weight: 450;
  margin: 0 16px;
  text-decoration: none;
  white-space: nowrap;
  padding: 2px 0;
}

/* 仅通过文字颜色和字重反馈交互（零渲染成本） */
.category-tag:hover, .category-tag.active {
  color: #10b981;
  font-weight: 600;
}

html.dark .category-tag {
  color: #bbb; /* 暗黑默认文字 */
}

html.dark .category-tag:hover, html.dark .category-tag.active {
  color: #4ade80;
}

/* 响应式适配（保持基础功能） */
@media (max-width: 768px) {
  .category-bg-bar {
    padding: 8px 16px;
    overflow-x: auto;
    justify-content: flex-start;
  }
  .category-tag {
    margin: 0 10px;
    font-size: 0.9rem;
  }
}
</style>

<div class="category-container">
  <div class="category-bg-bar">
    {{ $currentPage := . }}
    {{ range $categories }}
      {{ $categoryPage := .Page | default nil }}
      {{ if $categoryPage }}
        {{ $isActive := false }}
        {{ $currentRelPermalink := $currentPage.RelPermalink | lower | default "" }}
        {{ $categoryRelPermalink := $categoryPage.RelPermalink | lower | default "" }}

        {{ if eq $currentPage.Kind "term" }}
          {{ if or (eq $currentRelPermalink $categoryRelPermalink) (eq (lower $currentPage.Title | default "") (lower $categoryPage.Title | default "")) }}
            {{ $isActive = true }}
          {{ end }}
        {{ else if eq $currentPage.Kind "page" }}
          {{ range $currentPage.Params.categories | default slice }}
            {{ $articleCat := site.GetPage (printf "/categories/%s" .) | default nil }}
            {{ if and $articleCat (eq (lower $articleCat.RelPermalink | default "") $categoryRelPermalink) }}
              {{ $isActive = true }}
            {{ end }}
          {{ end }}
        {{ end }}

        <a href="{{ $categoryPage.RelPermalink }}" class="category-tag {{ if $isActive }}active{{ end }}" title="{{ $categoryPage.Name | default "分类" }}">
          {{ $categoryPage.Name | upper | default "UNKNOWN" }}
        </a>
      {{ end }}
    {{ end }}
  </div>
</div>
{{ end }}